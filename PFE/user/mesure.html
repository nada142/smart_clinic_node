<!DOCTYPE html>
<!--
This is a starter template page. Use this page to start your new project from
scratch. This page gets rid of all links and provides the needed markup only.
-->
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>We Care | Mesure</title>

    <!-- Google Font: Source Sans Pro -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback"
    />
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css" />
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/adminlte.min.css" />
  </head>
  <body class="hold-transition layout-top-nav">
    <div class="wrapper">
      <!-- Navbar -->
      <nav
        class="main-header navbar navbar-expand-md navbar-light navbar-white"
        style="background-color: #1362c9"
      >
        <div class="container">
          <a href="index.html" class="navbar-brand">
            <img
              src="patient.png"
              alt="AdminLTE Logo"
              class="brand-image img-circle elevation-3"
              style="opacity: 0.8"
            />
          </a>

          <button
            class="navbar-toggler order-1"
            type="button"
            data-toggle="collapse"
            data-target="#navbarCollapse"
            aria-controls="navbarCollapse"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse order-3" id="navbarCollapse">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
              <li class="nav-item">
                <a href="index.html" class="nav-link" style="color: azure"
                  >Home</a
                >
              </li>
              <li class="nav-item">
                <a href="rdv.html" class="nav-link" style="color: azure">
                  My Appointments</a
                >
              </li>
              <li class="nav-item dropdown">
                <a
                  id="dropdownSubMenu1"
                  href="#"
                  style="color: azure"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                  class="nav-link dropdown-toggle"
                  >My Documents</a
                >
                <ul
                  aria-labelledby="dropdownSubMenu1"
                  class="dropdown-menu border-0 shadow"
                >
                  <li>
                    <a href="ordonn.html" class="dropdown-item"
                      >My Prescriptions</a
                    >
                  </li>
                  <li>
                    <a href="certif.html" class="dropdown-item"
                      >My Medical Certificats</a
                    >
                  </li>
                  <li>
                    <a href="mesure.html" class="dropdown-item"
                      >Sensors Mesures</a
                    >
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="listDoc.html" class="nav-link" style="color: azure"
                  >List Doctors</a
                >
              </li>
              <li class="nav-item">
                <a
                  href="updateprofile.html"
                  id="username1"
                  class="nav-link"
                  style="color: azure"
                  >Profile</a
                >
              </li>
            </ul>
            <div>
              <input
                id="searchp"
                class="form-control form-control-sidebar"
                type="search"
                placeholder="Search"
                aria-label="Search"
              />
            </div>
            <!-- SEARCH FORM -->
            <a
              href="#"
              onclick="logout()"
              class="btn btn-default"
              style="color: #1362c9"
              >Log Out</a
            >
          </div>
          <!-- Right navbar links -->
          <ul class="order-1 order-md-3 navbar-nav navbar-no-expand ml-auto">
            <!-- Messages Dropdown Menu -->
            <li class="nav-item dropdown">
              <a
                class="nav-link"
                data-toggle="dropdown"
                href="message.html"
                style="color: azure"
              >
                <i class="far fa-comments"></i>
                <span class="badge badge-danger navbar-badge"></span>
              </a>
            </li>
            <!-- Notifications Dropdown Menu -->
            <li class="nav-item dropdown">
              <a
                class="nav-link"
                data-toggle="dropdown"
                href="notif.html"
                style="color: azure"
              >
                <i class="far fa-bell"></i>
                <span class="badge badge-warning navbar-badge"></span>
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                data-widget="control-sidebar"
                data-slide="true"
                href="#"
                role="button"
                style="color: azure"
              >
                <i class="fas fa-th-large"></i>
              </a>
            </li>
          </ul>
        </div>
      </nav>
      <!-- /.navbar -->

      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <div class="container-fluid">
            <div class="row mb-2">
              <div class="col-sm-6">
                <h1>Profile</h1>
              </div>
              <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                  <li class="breadcrumb-item"><a href="#">Home</a></li>
                  <li class="breadcrumb-item active">Profile</li>
                </ol>
              </div>
            </div>
          </div>
          <!-- /.container-fluid -->
        </section>

        <!-- Main content -->
        <section class="content">
          <div class="container-fluid">
            <!-- /.row -->
            <div class="row">
              <div class="col-12">
                <div class="card">
                  <div class="card-header">
                    <h3 class="card-title">Table</h3>

                    <div class="card-tools">
                      <div
                        class="input-group input-group-sm"
                        style="width: 150px"
                      >
                        <input
                          type="text"
                          name="table_search"
                          id="myInput"
                          onkeyup="recherche()"
                          class="form-control float-right"
                          placeholder="Search"
                        />

                        <div class="input-group-append">
                          <button
                            type="submit"
                            onclick="recherche()"
                            class="btn btn-default"
                          >
                            <i class="fas fa-search"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- /.card-header -->
                  <div class="card-body table-responsive p-0">
                    <span id="ecg"></span>
                    <span id="temp"></span>
                    <span id="status"></span>
                  </div>
                  <!-- /.card-body -->
                </div>
                <!-- /.card -->
              </div>
            </div>
          </div>
          <!-- /.container-fluid -->
        </section>
        <!-- /.content -->
      </div>
      <!-- /.content-wrapper -->
      <script>
        var sexe;
        var age;
        var c = localStorage.getItem("id");
        console.log(c);
        var url3 = "http://127.0.0.1:3000/patients/" + c;
        var xhr3 = new XMLHttpRequest();
        xhr3.open("GET", url3, true);
        xhr3.onload = function () {
          var patients = JSON.parse(xhr3.responseText);
          if (xhr3.readyState == 4 && xhr3.status == "200") {
            sexe = patients.gender;
            agee = patients.birthdate;

            age = parseInt("2022") - parseInt(agee.substring(0, 4));
            showDet(sexe, age);
          } else {
            console.log("error");
          }
        };
        xhr3.send(null);
      </script>
      <script>
        function showDet(sexe, age) {
          // Create a request variable and assign a new XMLHttpRequest object to it.
          var request = new XMLHttpRequest();
          // Open a new connection, using the GET request on the URL endpoint
          request.open("GET", "http://127.0.0.1:3000/mesures", true);
          request.onload = function () {
            // Begin accessing JSON data here
            var data = JSON.parse(this.response);
            var ecg = data[data.length - 1].ecg;
            var temp = data[data.length - 1].temp;
            document.getElementById("ecg").innerHTML =
              `ecg value : ` + ecg + `<br>`;
            document.getElementById("temp").innerHTML =
              `Temp value : ` + temp + `<br>`;
            if (temp > 39 && ecg > 50 && sexe == "Homme" && age > 55) {
              document.getElementById("status").innerHTML = "Status : Danger!!";
            }
            if (temp > 39 && ecg > 50 && sexe == "Femme" && age > 50) {
              document.getElementById("status").innerHTML = "Status : Danger!!";
            }
          };
          // Send request
          request.send();
        }
      </script>
      <script>
        function recherche() {
          var input, filter, table, tr, td, i, txtValue;
          input = document.getElementById("myInput");
          filter = input.value.toUpperCase();
          table = document.getElementById("mesure");
          tr = table.getElementsByTagName("tr");
          for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[1];
            if (td) {
              txtValue = td.textContent || td.innerText;
              if (txtValue.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
              } else {
                tr[i].style.display = "none";
              }
            }
          }
        }
      </script>
      <!-- /.content-wrapper -->

      <!-- Control Sidebar -->
      <aside class="control-sidebar control-sidebar-dark">
        <!-- Control sidebar content goes here -->
      </aside>
      <!-- /.control-sidebar -->

      <!-- Main Footer -->
      <footer class="main-footer">
        <strong
          >Copyright &copy; 2022
          <a href="https://chaabengroup.com">Chaaben Technology Group</a
          >.</strong
        >
        All rights reserved.
        <div class="float-right d-none d-sm-inline-block">
          <b>Version</b> 1.0
        </div>
      </footer>
    </div>
    <!-- ./wrapper -->
    <script>
      var res = document.getElementById("username1");
      res.innerHTML = localStorage.getItem("name");
    </script>

    <!--Log Out-->
    <script>
      function logout() {
        var c = window.confirm("want to log out");
        if (c == true) {
          localStorage.clear();
          location.replace("login.html");
        }
      }
    </script>
    <!-- REQUIRED SCRIPTS -->

    <!-- jQuery -->
    <script src="plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- AdminLTE App -->
    <script src="dist/js/adminlte.min.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="dist/js/demo.js"></script>
  </body>
</html>
